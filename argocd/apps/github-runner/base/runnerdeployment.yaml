apiVersion: actions.summerwind.dev/v1alpha1
kind: RunnerDeployment
metadata:
  name: runner-deployment
spec:
  template:
    spec:
      repository: stefan-raducan/k8s-tests
      labels: ["arc-runner"]
      # needed to build images
      dockerdWithinRunnerContainer: true
      # This requires the runner container to be privileged if using dind inside.
      # simplest config that ARC supports for DinD
      # Ref: https://github.com/actions/actions-runner-controller/blob/master/docs/detailed-docs.md#docker-in-docker
      containers:
        - name: runner
          image: summerwind/actions-runner-dind:latest
          env:
            - name: DOCKERD_IN_RUNNER
              value: "true"
            - name: OTEL_EXPORTER_OTLP_ENDPOINT
              value: http://opentelemetry-collector.opentelemetry.svc.cluster.local:4317
            - name: OTEL_RESOURCE_ATTRIBUTES
              value: service.name=gh-runner
